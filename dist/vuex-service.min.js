/*!
 * vuex-service v0.2.2 
 * (c) 2018 james kim
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vuex"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","vuex","lodash"],e):e(t.VuexService=t.VuexService||{},t.Vuex,t._)}(this,function(t,e,n){"use strict";function r(t,e){return function n(){if(!n.hookCalled)return n.hookCalled=!0,t.apply(e,arguments)}}function o(t,e,r){var o=e.$store?e.$store.getters:e.getters,i=Object.keys(o),s=r?new RegExp("^"+r+"/"):new RegExp("");n(i).filter(function(t){return s.test(t)}).map(function(e){var r=e.replace(s,"").split("/").join(".");n.set(t,r,o[e])}).value()}function i(t,e,r,o){var i=e.$store?e.$store._actions:e._actions,s=Object.keys(i),u=r?new RegExp("^"+r+"/"):new RegExp("");n(s).filter(function(t){return u.test(t)}).map(function(r){var i=r.replace(u,"").split("/").join(".");if(n.get(t,i))throw new Error("duplicate key");var s=e.$store?e.$store:e,a=function(t,e){var n,o=Array.prototype.slice.call(arguments);return n=1===o.length?t:o,s.dispatch(r,n)};n.set(t,i,m.hook(o,i,a)),n.set(t,"pre",n.partial(m.pre,o)),n.set(t,"post",n.partial(m.post,o))}).value()}function s(t,e,r,o){var i=e.$store?e.$store._mutations:e._mutations,s=Object.keys(i),u=r?new RegExp("^"+r+"/"):new RegExp("");n(s).filter(function(t){return u.test(t)}).map(function(r){var i=r.replace(u,"").split("/");i.splice(i.length-1,0,"m");var s=i.join("."),a=e.$store?e.$store:e,c=function(t,e){var n={},o=Array.prototype.slice.call(arguments);return n=1===o.length?t:o,a.commit(r,n)};n.set(t,s,m.hook(o,s,c)),n.set(t,"pre",n.partial(m.pre,o)),n.set(t,"post",n.partial(m.post,o))}).value()}function u(t,e,n){a(e.$store?e.$store.state:e.state,n.split("/").join("."),t)}function a(t,e,r){var o=e?Object.keys(n.get(t,e)):Object.keys(t);n(o).map(function(o){if(n.get(r,o)){a(e?n.get(t,e):t,o,r[o])}else{var i=e?e+"."+o:o;n.set(r,o,n.get(t,i))}}).value()}function c(t,e){void 0===t&&(t="");var r=this;e&&(r=e);var a,c=t.trim().replace(" ","").split(","),f={};return c.forEach(function(t){var e=/.+\/([-_\w\d]+)$/;a=(e.test(t)?e.exec(t)[1]:t)||"Root";var c={};o(c,r,t),i(c,r,t,a),s(c,r,t,a),u(c,r,t),n.merge(c,y.getInstance(t)),f[a]=c}),c.length>1?f:f[a]}function f(t,n){void 0===n&&(n={});var r="$$store";t.prototype.hasOwnProperty(r)||(Object.defineProperty(t.prototype,r,{get:function(){return c}}),e.Store.prototype[r]=c)}e="default"in e?e.default:e,n="default"in n?n.default:n;var p={set:function(t,e){var r=e[0],o=e[1];n.set(t,r,o)},add:function(t,e){var r=e[0],o=e[1];n.get(t,r).push(o)},update:function(t,e){var r=e[0],o=e[1];n.isString(r)?n.set(t,r,o):n.merge(r,o)},remove:function(t,e){var r=e[0],o=e[1];n.get(t,r).splice(n.get(t,r).indexOf(o),1)}},l="$$tinyEventListeners",h=function(){this.events={}};h.prototype.$on=function(t,e,n){this[l]||(this[l]={});var r=this[l];if(r[e]||(r[e]=[]),r[e].push(n),t&&t.$on){var o=this;t.$on("hook:beforeDestroy",function(){o.$off(e,n)})}return this},h.prototype.$once=function(t,e,n,r){var o=this,i=function(){r.apply(this,arguments),o.$off(e,i),o.$off(n,i)};return this.$on(t,e,i),this.$on(t,n,i),this},h.prototype.$off=function(t,e){if(!this[l]||!this[l][t])return this;var n=this[l];if(e){var r=n[t],o=r.indexOf(e);o>-1&&r.splice(o,1)}else delete n[t];return this},h.prototype.getListeners=function(t){var e=this;return Object.keys(e[l]).filter(function(e){return new RegExp(e.replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(t)}).reduce(function(t,n){return t.concat(e[l][n])},[])},h.prototype.$emit=function(t){if(this[l]){for(var e=this.getListeners.call(this,t),n=[].slice.call(arguments,1),r=0;r<e.length;r++)e[r].apply(null,n);return this}},h.prototype.getInstance=function(t){var e=this;if(this.events[t])return this.events[t];var n={$emit:function(n,r){e.$emit(t+"."+n,r)},$broadcast:function(t,n){e.$emit("__All__."+t,n)},$on:function(n,r,o){"string"==typeof n&&(o=r,r=n,n=null),e.$on(n,t+"."+r,o),e.$on(n,"__All__."+r,o)},$once:function(n,r,o){"string"==typeof n&&(o=r,r=n,n=null),e.$once(n,t+"."+r,"__All__."+r,o)},$off:function(n,r){e.$off(t+"."+n,r),e.$off("__All__."+n,r)}};return this.events[t]=n,n};var y=new h,v={},g={},$={},d=function(){};d.prototype.hook=function(t,e,n,o){var i=$[t]=$[t]||{},s=v[t]=v[t]||{},u=g[t]=g[t]||{};return s[e]=s[e]||[],u[e]=u[e]||[],i[e]?i[e]:(i[e]=function(){function t(t){if(t&&t instanceof Error)return a(t);--g||d.apply(f,c)}function a(t){if("function"==typeof p)return p(t);if(o)return o.call(f,t);throw t}var c,f=this,p=arguments[arguments.length-1],l=s[e],h=u[e],y=l.length,v=-1,g=i[e].numAsyncPres,$=function(){if(arguments[0]instanceof Error)return a(arguments[0]);var n,o,s=Array.prototype.slice.call(arguments);if(!s.length||null==arguments[0]&&"function"==typeof p||(c=s),++v<y){if(n=l[v],n.isAsync&&n.length<2)throw new Error("Your pre must have next and done arguments -- e.g., function (next, done, ...)");if(n.length<1)throw new Error("Your pre must have a next argument -- e.g., function (next, ...)");return o=(n.isAsync?[r($),r(t)]:[r($)]).concat(c),n.apply(f,o)}return i[e].numAsyncPres?void 0:d.apply(f,c)},d=function(){var t,e,o,i,s=Array.prototype.slice.call(arguments);if(v===y)return i=function(){if(arguments[0]instanceof Error)return a(arguments[0]);var t,n,s=Array.prototype.slice.call(arguments,1);if(s.length&&(c=s),++o<e){if(t=h[o],t.length<1)throw new Error("Your post must have a next argument -- e.g., function (next, ...)");return n=[r(i)].concat(c),t.apply(f,n)}return"function"==typeof p?p.apply(f,arguments):void 0},"function"==typeof p&&(s[s.length-1]=r(i)),e=h.length,o=-1,t=n.apply(f,s),e&&"function"!=typeof p?i():t};return $.apply(this,arguments)},i[e].numAsyncPres=0,i[e])},d.prototype.pre=function(t,e,n,r,o){"boolean"!=typeof arguments[2]&&(o=r,r=n,n=!1);var i=$[t]=$[t]||{},s=v[t]=v[t]||{};return this._lazySetupHooks(t,i,e,o),(r.isAsync=n)&&i[e].numAsyncPres++,(s[e]=s[e]||[]).push(r),this},d.prototype.post=function(t,e,n,r){3===arguments.length&&(r=n,n=!1);var o=$[t]=$[t]||{},i=g[t]=g[t]||{};return this._lazySetupHooks(t,o,e),(i[e]=i[e]||[]).push(r),this},d.prototype.removePre=function(t,e,n){var r=($[t]=$[t]||{},v[t]=v[t]||{});return r[e]?(2===arguments.length?r[e].length=0:r[e]=r[e].filter(function(t){return t!==n}),this):this},d.prototype._lazySetupHooks=function(t,e,n,r){if(!e[n])throw new Error("There is no "+t+"."+n+" action/mutation function.");void 0===e[n].numAsyncPres&&this.hook(n,e[n],r)};var m=new d;n.bindAll(m,function(t){return n.without(Object.getOwnPropertyNames(Object.getPrototypeOf(t)),"constructor")}(m)),f.version="0.2.2",t.default=f,t.Store=c,t.defaultMutations=p,Object.defineProperty(t,"__esModule",{value:!0})});